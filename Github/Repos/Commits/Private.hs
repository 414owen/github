{-# LANGUAGE OverloadedStrings #-}
module Github.Repos.Commits.Private where

import Github.Data
import Data.Aeson
import Data.Attoparsec
import Control.Applicative
import Data.List
import qualified Data.ByteString.Char8 as BS

parseCommitsJson :: BS.ByteString -> Either String [Commit]
parseCommitsJson jsonString =
  let parsed = parse (fromJSON <$> json) jsonString in
  case parsed of
       Data.Attoparsec.Done _ jsonResult -> do
         case jsonResult of
              (Success s) -> Right s
              anythingElse ->  Left $ show anythingElse
       undone -> Left $ show undone

buildUrl :: [String] -> String
buildUrl = intercalate "/"

githubApiGet :: String -> IO BS.ByteString
githubApiGet url = return $ BS.pack " [ { \"sha\": \"4d9a46e953cfdac1427c5e0683a5f26c8f9452e4\", \"parents\": [ { \"sha\": \"43b635d351d9c1ff583116acc6212b86dec178d0\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/commits/43b635d351d9c1ff583116acc6212b86dec178d0\" } ], \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/commits/4d9a46e953cfdac1427c5e0683a5f26c8f9452e4\", \"commit\": { \"message\": \"Use download-curl to remove a method.\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/git/commits/4d9a46e953cfdac1427c5e0683a5f26c8f9452e4\", \"committer\": { \"email\": \"mike@mike-burns.com\", \"date\": \"2011-10-29T14:21:19-07:00\", \"name\": \"Mike Burns\" }, \"tree\": { \"sha\": \"84daae503bad5436683e7dee25cf6ab28a5b4c1a\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/git/trees/84daae503bad5436683e7dee25cf6ab28a5b4c1a\" }, \"author\": { \"email\": \"mike@mike-burns.com\", \"date\": \"2011-10-29T14:21:19-07:00\", \"name\": \"Mike Burns\" } }, \"committer\": { \"avatar_url\": \"https://secure.gravatar.com/avatar/fd94ce930718a1f08c623dff2d04436f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png\", \"login\": \"mike-burns\", \"url\": \"https://api.github.com/users/mike-burns\", \"id\": 4550, \"gravatar_id\": \"fd94ce930718a1f08c623dff2d04436f\" }, \"author\": { \"avatar_url\": \"https://secure.gravatar.com/avatar/fd94ce930718a1f08c623dff2d04436f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png\", \"login\": \"mike-burns\", \"url\": \"https://api.github.com/users/mike-burns\", \"id\": 4550, \"gravatar_id\": \"fd94ce930718a1f08c623dff2d04436f\" } }, { \"sha\": \"43b635d351d9c1ff583116acc6212b86dec178d0\", \"parents\": [ { \"sha\": \"1e375b1ef68abc629248c5785aabf38437fa1491\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/commits/1e375b1ef68abc629248c5785aabf38437fa1491\" } ], \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/commits/43b635d351d9c1ff583116acc6212b86dec178d0\", \"commit\": { \"message\": \"Only show commits from the past week. Also, only show repos with commits.\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/git/commits/43b635d351d9c1ff583116acc6212b86dec178d0\", \"committer\": { \"email\": \"mike@mike-burns.com\", \"date\": \"2011-10-29T14:12:56-07:00\", \"name\": \"Mike Burns\" }, \"tree\": { \"sha\": \"5888bb4ea554a18ce69ac650b3452109d9cb5e15\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/git/trees/5888bb4ea554a18ce69ac650b3452109d9cb5e15\" }, \"author\": { \"email\": \"mike@mike-burns.com\", \"date\": \"2011-10-29T14:12:56-07:00\", \"name\": \"Mike Burns\" } }, \"committer\": { \"avatar_url\": \"https://secure.gravatar.com/avatar/fd94ce930718a1f08c623dff2d04436f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png\", \"login\": \"mike-burns\", \"url\": \"https://api.github.com/users/mike-burns\", \"id\": 4550, \"gravatar_id\": \"fd94ce930718a1f08c623dff2d04436f\" }, \"author\": { \"avatar_url\": \"https://secure.gravatar.com/avatar/fd94ce930718a1f08c623dff2d04436f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png\", \"login\": \"mike-burns\", \"url\": \"https://api.github.com/users/mike-burns\", \"id\": 4550, \"gravatar_id\": \"fd94ce930718a1f08c623dff2d04436f\" } }, { \"sha\": \"1e375b1ef68abc629248c5785aabf38437fa1491\", \"parents\": [ { \"sha\": \"d8832662b721d624a91dc4074c490b7d8e959fc3\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/commits/d8832662b721d624a91dc4074c490b7d8e959fc3\" } ], \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/commits/1e375b1ef68abc629248c5785aabf38437fa1491\", \"commit\": { \"message\": \"Pulls down the proper commit JSON, turns it into correct underlying data structures, fills in the short SHA.\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/git/commits/1e375b1ef68abc629248c5785aabf38437fa1491\", \"committer\": { \"email\": \"mike@mike-burns.com\", \"date\": \"2011-10-29T13:16:36-07:00\", \"name\": \"Mike Burns\" }, \"tree\": { \"sha\": \"993502ab6d33caeb21d8079293eb27707fa15230\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/git/trees/993502ab6d33caeb21d8079293eb27707fa15230\" }, \"author\": { \"email\": \"mike@mike-burns.com\", \"date\": \"2011-10-29T13:16:36-07:00\", \"name\": \"Mike Burns\" } }, \"committer\": { \"avatar_url\": \"https://secure.gravatar.com/avatar/fd94ce930718a1f08c623dff2d04436f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png\", \"login\": \"mike-burns\", \"url\": \"https://api.github.com/users/mike-burns\", \"id\": 4550, \"gravatar_id\": \"fd94ce930718a1f08c623dff2d04436f\" }, \"author\": { \"avatar_url\": \"https://secure.gravatar.com/avatar/fd94ce930718a1f08c623dff2d04436f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png\", \"login\": \"mike-burns\", \"url\": \"https://api.github.com/users/mike-burns\", \"id\": 4550, \"gravatar_id\": \"fd94ce930718a1f08c623dff2d04436f\" } }, { \"sha\": \"d8832662b721d624a91dc4074c490b7d8e959fc3\", \"parents\": [ { \"sha\": \"0725e2fd77fc1ad6ae051ba3d8cb29338ecb2c2e\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/commits/0725e2fd77fc1ad6ae051ba3d8cb29338ecb2c2e\" } ], \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/commits/d8832662b721d624a91dc4074c490b7d8e959fc3\", \"commit\": { \"message\": \"Compiles and runs, but does not hit the Internet.\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/git/commits/d8832662b721d624a91dc4074c490b7d8e959fc3\", \"committer\": { \"email\": \"mike@mike-burns.com\", \"date\": \"2011-10-27T16:27:53-07:00\", \"name\": \"Mike Burns\" }, \"tree\": { \"sha\": \"cc83b231ec80f8f35f040822f6b0b750eb72ad72\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/git/trees/cc83b231ec80f8f35f040822f6b0b750eb72ad72\" }, \"author\": { \"email\": \"mike@mike-burns.com\", \"date\": \"2011-10-27T16:27:53-07:00\", \"name\": \"Mike Burns\" } }, \"committer\": { \"avatar_url\": \"https://secure.gravatar.com/avatar/fd94ce930718a1f08c623dff2d04436f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png\", \"login\": \"mike-burns\", \"url\": \"https://api.github.com/users/mike-burns\", \"id\": 4550, \"gravatar_id\": \"fd94ce930718a1f08c623dff2d04436f\" }, \"author\": { \"avatar_url\": \"https://secure.gravatar.com/avatar/fd94ce930718a1f08c623dff2d04436f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png\", \"login\": \"mike-burns\", \"url\": \"https://api.github.com/users/mike-burns\", \"id\": 4550, \"gravatar_id\": \"fd94ce930718a1f08c623dff2d04436f\" } }, { \"sha\": \"0725e2fd77fc1ad6ae051ba3d8cb29338ecb2c2e\", \"parents\": [ ], \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/commits/0725e2fd77fc1ad6ae051ba3d8cb29338ecb2c2e\", \"commit\": { \"message\": \"Skeleton cabal structure.\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/git/commits/0725e2fd77fc1ad6ae051ba3d8cb29338ecb2c2e\", \"committer\": { \"email\": \"mike@mike-burns.com\", \"date\": \"2011-10-27T16:27:29-07:00\", \"name\": \"Mike Burns\" }, \"tree\": { \"sha\": \"dfaa5eeef83494cefca577f7904f748aee745d36\", \"url\": \"https://api.github.com/repos/mike-burns/this-week-in-open-source/git/trees/dfaa5eeef83494cefca577f7904f748aee745d36\" }, \"author\": { \"email\": \"mike@mike-burns.com\", \"date\": \"2011-10-27T16:27:02-07:00\", \"name\": \"Mike Burns\" } }, \"committer\": { \"avatar_url\": \"https://secure.gravatar.com/avatar/fd94ce930718a1f08c623dff2d04436f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png\", \"login\": \"mike-burns\", \"url\": \"https://api.github.com/users/mike-burns\", \"id\": 4550, \"gravatar_id\": \"fd94ce930718a1f08c623dff2d04436f\" }, \"author\": { \"avatar_url\": \"https://secure.gravatar.com/avatar/fd94ce930718a1f08c623dff2d04436f?d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-140.png\", \"login\": \"mike-burns\", \"url\": \"https://api.github.com/users/mike-burns\", \"id\": 4550, \"gravatar_id\": \"fd94ce930718a1f08c623dff2d04436f\" } } ] "
